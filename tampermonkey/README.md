# ğŸ¬ YouTube å¼¹å¹•æ’­æ”¾è„šæœ¬ï¼ˆåŠ è½½æœ¬åœ° Bç«™ å¼¹å¹•ï¼‰

> ä¸€æ¬¾ç”¨äºåœ¨ YouTube ä¸ŠåŠ è½½æœ¬åœ°Bç«™å¼¹å¹•å¹¶æ˜¾ç¤ºåŒæ­¥å¼¹å¹•çš„æ²¹çŒ´ç”¨æˆ·è„šæœ¬ï¼ˆé…åˆ [Bç«™å¼¹å¹•çˆ¬è™«](../bilibili_crawler/README.md) æˆ– [Bç«™å¼¹å¹•ä¸‹è½½è„šæœ¬](https://greasyfork.org/zh-CN/scripts/534432-bilibili-%E8%A7%86%E9%A2%91%E5%BC%B9%E5%B9%95%E7%BB%9F%E8%AE%A1-%E4%B8%8B%E8%BD%BD-%E6%9F%A5%E8%AF%A2%E5%8F%91%E9%80%81%E8%80%85) è·å–Bç«™å¼¹å¹•ï¼‰ï¼Œæ”¯æŒé¡¶éƒ¨/åº•éƒ¨å¼¹å¹•ã€é¢œè‰²å­—å·ç­‰åŠŸèƒ½ã€‚


## âœ¨ åŠŸèƒ½ç‰¹è‰²

* âœ… åŠ è½½æœ¬åœ°å¼¹å¹•ï¼ˆç”± B ç«™å¼¹å¹• XML è½¬æ¢è€Œæˆçš„ `.json`ï¼‰
* âœ… è‡ªåŠ¨åŒæ­¥å¼¹å¹•æ’­æ”¾ï¼Œè‡ªåŠ¨åˆ†é…å¼¹å¹•è½¨é“ï¼Œé˜²æ­¢é‡å 
* âœ… æ”¯æŒé¡¶éƒ¨ / åº•éƒ¨ / æ»šåŠ¨å¼¹å¹•ï¼Œæ”¯æŒæ˜¾ç¤ºå¼¹å¹•é¢œè‰²ã€å­—å·
* âœ… æ”¯æŒç¼“å­˜å¼¹å¹•ï¼Œä¸‹æ¬¡æ‰“å¼€é¡µé¢è‡ªåŠ¨æ¢å¤
* âœ… æ”¯æŒå¿«æ·é”®`D`å¼€å…³å¼¹å¹•
* âœ… æ”¯æŒé…ç½®[æœåŠ¡å™¨](../bilibili_crawler/README.md#-bilibili-å¼¹å¹•æ¥å£æœåŠ¡serverpy)åœ°å€ï¼Œé€šè¿‡æœåŠ¡å™¨æœç´¢Bç«™åŒåè§†é¢‘å¼¹å¹•
* `1.3ç‰ˆæœ¬`æ”¯æŒåœ¨Bç«™æ’­æ”¾å¼¹å¹•ï¼ˆå€’ä¸æ˜¯è„±è£¤å­æ”¾å±ï¼Œå¯ä»¥å°è¯•åœ¨è¡¥æ¡£è§†é¢‘çœ‹åŸè§†é¢‘å¼¹å¹•ï¼‰


## ğŸ–¼ï¸ æ•ˆæœé¢„è§ˆ

![demo01](../images/youtube-danmaku-player-example01.png)

![demo02](../images/youtube-danmaku-player-example02.png)


## ğŸš€ ä½¿ç”¨æ–¹æ³•

1. å®‰è£…æµè§ˆå™¨æ’ä»¶ [Tampermonkey](https://www.tampermonkey.net/)
2. æ–°å»ºç”¨æˆ·è„šæœ¬ï¼Œç²˜è´´æœ¬é¡¹ç›®çš„ `userscript.js` è„šæœ¬å†…å®¹
3. æ‰“å¼€ä»»æ„ [YouTube è§†é¢‘](https://www.youtube.com/watch)
4. é¼ æ ‡æ‚¬åœåœ¨å±å¹•å·¦è¾¹å¼¹å‡ºçš„æ§åˆ¶é¢æ¿ï¼Œç‚¹å‡»ï¼š

   * ğŸ“‚ã€è½½å…¥å¼¹å¹•ã€‘æŒ‰é’®ï¼Œé€‰æ‹©ä½ çš„æœ¬åœ° `.json` å¼¹å¹•æ•°æ®
   * âœ…ã€å¼¹å¹•å¼€/å…³ã€‘å¯éšæ—¶æ§åˆ¶æ˜¾ç¤ºçŠ¶æ€
5. æ’­æ”¾è§†é¢‘ï¼Œå¼¹å¹•å°†è‡ªåŠ¨åŒæ­¥æ¼‚æµ®æ˜¾ç¤º
6. æœç´¢Bç«™åŒåè§†é¢‘å¼¹å¹•åŠŸèƒ½éœ€è‡ªè¡Œå¸ƒç½®æœåŠ¡å™¨ï¼ˆ[`server.py`](../bilibili_crawler/server.py)ï¼‰
7. ç‚¹å‡»âš™ï¸è®¾ç½®æœåŠ¡å™¨åœ°å€ï¼Œç„¶åå°±å¯ä»¥ç‚¹å‡»ğŸ”æœç´¢Bç«™åŒåè§†é¢‘è·å–å¼¹å¹•äº†ã€‚å¯ä»¥ä¿®æ”¹æ ‡é¢˜ï¼Œenteré‡æ–°æœç´¢ã€‚

## ğŸ“¦ å¼¹å¹•æ–‡ä»¶è¦æ±‚

è¯·ä½¿ç”¨ä½ è‡ªå·±çš„çˆ¬è™«å·¥å…·æˆ–æ‰‹åŠ¨ä¸‹è½½ï¼Œç”Ÿæˆå¦‚ä¸‹æ ¼å¼çš„ JSONï¼š

```json
{
  "bvid": "BV1xx4117xYz",
  "cid": 12345678,
  "videoData": {
    "title": "...",
    "pic": "...",
    ...
  },
  "danmakuData": [
    {
      "progress": 12340,
      "mode": 1,
      "fontsize": 25,
      "color": 16777215,
      "ctime": 1615020559,
      "pool": 1,
      "midHash": "abcdef",
      "dmid": "123456789",
      "weight": 0,
      "content": "å“ˆå“ˆå“ˆå“ˆ"
    }
  ],
  "fetchtime": 1747363751
}
```

> YouTubeä¸è®©è„šæœ¬ç”¨DOMParserå¤„ç†æœ¬åœ°xmlæ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦é¢„å…ˆè½¬ä¸ºjsonã€‚
> 
> å…¶ä¸­å¿…é¡»å«æœ‰danmakuDataï¼Œå…¶ä»–æ•°æ®å¯é€‰ã€‚
> 
> å¤„ç†å¼¹å¹•xmlå¯å‚è€ƒ [BiliBili XMLå¼¹å¹•](https://github.com/SocialSisterYi/bilibili-API-collect/blob/master/docs/danmaku/danmaku_xml.md) ã€‚




